# idz-3-dribnokhod
#### Вариант 35, Дрибноход Евгений
#### Программа является решнием индивидуального домашнего задания 3, на оценку 7
### Формулировка условия
Председатель дачного кооператива СидоровВ.И. получил указание, что всвязи с составлением единого земельного кадастра, необходимо представить справку о площади занимаемых земель.
Известно, что территория с запада и востока параллельна меридианам, на севере ограничены параллелью, а с юга выходят к реке, описываемой функцией f(x). Требуется создать приложение,
вычисляющее площадь угодий методом адаптивной квадратуры. Замечание: кривизну Земли из за малой занимаемой площади не учитывать. Количество процессов, участвующих в вычислениях определяется
опционально. Агроном нанимает счетоводов, каждый из которых обсчитывает небольшой участок после чего добавляет свой результат к общей площади полученной входе проводимых расчетов.
После этого агроном назначает ему следующий свободный участок для проведения расчета. Агроном—сервер. Каждый счетовод — клиент.
### Инструкция к запуску
Для запуска решения на соответствующую оценку, требуется перейти в папку соответсветствующей оценки, (опционально, скомпилировать файлы с помощью cmake) и запустить следующие команды:
1. Запуск сервера ./TCPEchoServer-Fork <Server Port> <Observer Port> (Порт обсервера добавляется только для решения на оценку 6-7)
2. Запуск наблюдателя ./TCPObserver <IP server> <Observer Port> (Производится только в решении на оценку 6-7) 
3. Запуск клиента ./TCPEchoClientLoop <IP server> <Server port>
### Алгоритмы работы
#### Алгоритм 4-5
1. Сервер, попадает в цикл, в котором ожидает подключения клиентов.
2. При подключении лиента, сервер создает процесс обслуживающий клиента, проверяет на выполненность работы и есл работа не выполнена встает в режим ожидания новых клиентов.
3. Дополнительный процесс сервера, используя разделяемую память, получает значение левой и правой границы полоски, которую нужно расчитать.
4. Процесс сервера передает значения левой и правой границы клиенту по TCP соединению.
5. Процесс клиента получив границы, расчитывает площать и возвращает ее значение по TCP соединению.
6. Доплнительный процесс сервера прибавляет полученную площать к общей площади и если процесс расчета еще не окончен другими процессами, повторяет цикл расчета.
7. После завершения расчета всей площади, процессы сервера передают клиентам отрицательные значения границ, а после завершаются.
8. Процессы клиентов, получив отрицательные значения границ, завершаются.
9. После подключения очередного клиента, если расчет уже окончен на момент подключения клиента, сервер замечает что расчет окончен, выводит значение общей суммы и завершается.
#### Алгоритм 6-7
1. Сервер ожидает подключения наблюдателя.
2. Сервер перенаправляет stdout на соккет связанный с наблюдателем.
3. Наблюдатель попадает в цикл, в котором принимает данные от сервера и выводит их в консоль.
4. Расчет площади аналогичный оценке 4-5, с аналогичным выводом всей информации о состоянии системы в stdout, но с включенной переадресацией на наблюдателя.
5. Перед завершением работы сервера, вывод в stdout символа #.
7. При получении символа #, наблюдатель завершает работу.
  
### Отчет 4-5
1. Передача IP и портов происходит через аргументы командной строки.
2. Система работает как на одном компьютере так и на нескольких.
3. Завершение работы клиентов и сервера осуществляется.
  
  Демонстрация работы:
  ![image](https://github.com/zemlianin/idz-3-dribnokhod/assets/62663368/1d74c340-973a-46cf-a4e4-3a0a627370b8)

  
### Отчет 6-7
  Предоставлен клиент для отображения информации о работе системы в целом.
  Для достижения данной цели, была осуществлена модерниизация клиентов,
  они стали передовать информацию о себе - серверу. Также, сервер стал выводить информацию о себе и о клиентах в stdout.
  Сервер стал ожидать нового подключения наблюдателя и осуществлять перенаправление stdout на соккет с наблюдателем.
  Был реализован наблюдатель, осуществляющий посимвольный вывод информации от сервера.
  
  Демонстрация работы:
  ![image](https://github.com/zemlianin/idz-3-dribnokhod/assets/62663368/3bf8d64d-213c-4152-acc7-5bcc999a7430)
